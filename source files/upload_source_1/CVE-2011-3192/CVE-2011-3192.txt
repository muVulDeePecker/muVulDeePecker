diff -ru modules/http/byterange_filter.c.org
modules/http/byterange_filter.c |less
--- byterange_filter.c  2011-02-13 15:32:19.000000000 +0100
+++ modules/http/byterange_filter.c     2011-08-23 15:54:37.000000000 +0200
@@ -320,6 +320,7 @@
     const char *if_range;
     const char *match;
     const char *ct;
+    char * tmp;
     int num_ranges;

     if (r->assbackwards) {
@@ -373,14 +374,13 @@
         }
     }

-    if (!ap_strchr_c(range, ',')) {
-        /* a single range */
-        num_ranges = 1;
-    }
-    else {
-        /* a multiple range */
-        num_ranges = 2;
-    }
+    /* count ranges, exit if more then 10 */
+    tmp=range+6;
+    num_ranges=1;
+    while(*++tmp)
+        if(*tmp == ',')
+           if(++num_ranges > 10)
+               return 0;

     r->status = HTTP_PARTIAL_CONTENT;
     r->range = range + 6;
